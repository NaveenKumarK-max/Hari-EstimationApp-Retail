/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, Output, EventEmitter } from '@angular/core';
import DEFAULTS from './misc/defaults';
import { EMOJIS } from './misc/emojis.data';
import { EMOS } from './misc/emos.data';
var NgxEmojComponent = /** @class */ (function () {
    function NgxEmojComponent() {
        this.DEFAULTS = DEFAULTS;
        this.onemojipick = new EventEmitter;
        this.onchardelete = new EventEmitter;
        // Initially  apply default config...
        this.theme = {};
        this.emojiCategories = [];
        // list of emos type, e.g emoji, gifs, stickers...
        this.emos = [];
        this.hideFooter = false;
    }
    /**
     * @return {?}
     */
    NgxEmojComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        // Set recent emoji store key...
        this.emojiDBKey = this.recentEmojiStoreKey || DEFAULTS.recentEmojiStoreKey;
        // Get recent emojis..
        this.emojiDB = window.localStorage.getItem(this.emojiDBKey);
        if (this.emojiDB) {
            this.emojiDB = JSON.parse(this.emojiDB);
        }
        else {
            // no stored recent emoji, save in the store array ...
            this.emojiDB = [];
            window.localStorage.setItem(this.emojiDBKey, JSON.stringify(this.emojiDB));
        }
        this.activeCategory = 'People';
        // get the emoji categories
        this.emojiCategories = EMOJIS.map(function (value) {
            return { name: value.name, icon: value.icon };
        });
        // filter to set defaults
        this.activeEmojiSet = EMOJIS.filter(function (category) {
            if (category.name === _this.activeCategory) {
                return category;
            }
        });
        this.activeIndex = this.activeEmojiSet[0].id;
        // console.log('Initial Emo Index:', this.activeIndex);
        this.activeEmojiSet = this.activeEmojiSet[0].emojis;
        this.activeEmo = 'Emoji';
        // collate the emos type
        this.emos = EMOS.map(function (value) {
            return { name: value.name, icon: value.icon };
        });
    };
    /**
     * @param {?} e
     * @return {?}
     */
    NgxEmojComponent.prototype.handleCategoryChange = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        var _this = this;
        // set active category name...
        this.activeCategory = e.name;
        if (e.name === 'Recent') {
            // If recent category, set emoji to emojis in the recent store...
            this.activeIndex = EMOJIS[1].id;
            this.activeEmojiSet = this.emojiDB;
        }
        else if (e.name === 'Search') {
            this.activeIndex = EMOJIS[0].id;
            this.activeEmojiSet = this.emojiDB.concat(EMOJIS[2].emojis);
        }
        else {
            // filter to set current emoji set...
            this.activeEmojiSet = EMOJIS.filter(function (category) {
                if (category.name === _this.activeCategory) {
                    return category;
                }
            });
            // update the index on manual change...
            this.activeIndex = this.activeEmojiSet[0].id;
            this.activeEmojiSet = this.activeEmojiSet[0].emojis;
        }
    };
    /**
     * @param {?} e
     * @return {?}
     */
    NgxEmojComponent.prototype.handleEmoChange = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        this.activeEmo = e.name;
        // collate the emos type
        //   this.emos = EMOS.map((value) => {
        //    return {name: value.name, icon: value.icon};
        //  });
    };
    /**
     * @param {?} name
     * @return {?}
     */
    NgxEmojComponent.prototype.checkIfEmojiExistsInEmojiDB = /**
     * @param {?} name
     * @return {?}
     */
    function (name) {
        /** @type {?} */
        var emo_exists = false;
        // checks if emoji is already in recent emoji db store...
        for (var i = 0; i < this.emojiDB.length; i++) {
            if (this.emojiDB[i][1] === name) {
                emo_exists = true;
                break;
            }
        }
        return emo_exists;
    };
    /**
     * @param {?} emoji
     * @return {?}
     */
    NgxEmojComponent.prototype.addEmojiToRecentEmojiDB = /**
     * @param {?} emoji
     * @return {?}
     */
    function (emoji) {
        // check if there is no duplicate
        if (!this.checkIfEmojiExistsInEmojiDB(emoji[1])) {
            // recent emoji greater than the number of max, remove the first emoji and add new one
            // to the back...
            if (this.emojiDB.length < (this.maxRecentEmoji || DEFAULTS.maxRecentEmoji)) {
                this.emojiDB.push(emoji);
                window.localStorage.setItem(this.emojiDBKey, JSON.stringify(this.emojiDB));
            }
            else {
                this.emojiDB.splice(0, 1);
                this.emojiDB.push(emoji);
                window.localStorage.setItem(this.emojiDBKey, JSON.stringify(this.emojiDB));
            }
        }
    };
    /**
     * @param {?} e
     * @return {?}
     */
    NgxEmojComponent.prototype.handleEmojiPick = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        // save the picked emoji inside recent emoji DB
        this.addEmojiToRecentEmojiDB(e.emoji);
        this.onemojipick.emit({ char: e.emoji[0], name: e.emoji[1] });
    };
    /**
     * @param {?} e
     * @return {?}
     */
    NgxEmojComponent.prototype.handleCharDelete = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        this.onchardelete.emit({ deleteChar: true });
    };
    /**
     * @param {?} e
     * @return {?}
     */
    NgxEmojComponent.prototype.handleContentScroll = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        // console.log('emitted', e.scrollTop, e.scrollHeight);
        if ((e.scrollHeight - e.scrollTop) <= 400) {
            // console.log('almost at the end');
            this.hideFooter = true;
        }
        else {
            // console.log('tooping the scroll');
            this.hideFooter = false;
        }
    };
    /**
     * @param {?} e
     * @return {?}
     */
    NgxEmojComponent.prototype.handleContentSwipe = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        /** @type {?} */
        var currentIndex = this.activeIndex;
        /** @type {?} */
        var direction = e.direction;
        // Log the necessary details...
        if (direction === 'left') {
            /** @type {?} */
            var prev_1 = currentIndex - 1;
            if (prev_1 >= 0) {
                if (prev_1 === 0) {
                    // search
                    this.activeIndex = EMOJIS[0].id;
                    this.activeCategory = EMOJIS[0].name;
                    this.activeEmojiSet = this.emojiDB.concat(EMOJIS[2].emojis);
                }
                else if (prev_1 === 1) {
                    // recent
                    this.activeIndex = EMOJIS[1].id;
                    this.activeCategory = EMOJIS[1].name;
                    this.activeEmojiSet = this.emojiDB;
                }
                else {
                    /** @type {?} */
                    var prevCategoryData = EMOJIS.filter(function (category) {
                        if (category.id === prev_1) {
                            return category;
                        }
                    });
                    // set the values...
                    this.activeIndex = prev_1;
                    this.activeCategory = prevCategoryData[0].name;
                    this.activeEmojiSet = prevCategoryData[0].emojis;
                }
            }
        }
        else if (direction === 'right') {
            /** @type {?} */
            var next_1 = currentIndex + 1;
            if (next_1 === 0) {
                // search
                this.activeIndex = EMOJIS[0].id;
                this.activeCategory = EMOJIS[0].name;
                this.activeEmojiSet = this.emojiDB.concat(EMOJIS[2].emojis);
            }
            else if (next_1 === 1) {
                // recent
                this.activeIndex = EMOJIS[1].id;
                this.activeEmojiSet = this.emojiDB;
                this.activeCategory = EMOJIS[1].name;
            }
            else {
                if (next_1 <= (EMOJIS.length - 1)) {
                    /** @type {?} */
                    var prevCategoryData = EMOJIS.filter(function (category) {
                        if (category.id === next_1) {
                            return category;
                        }
                    });
                    // set the values...
                    this.activeIndex = next_1;
                    this.activeCategory = prevCategoryData[0].name;
                    this.activeEmojiSet = prevCategoryData[0].emojis;
                }
            }
        }
    };
    NgxEmojComponent.decorators = [
        { type: Component, args: [{
                    selector: 'ngx-emoj',
                    template: "\n    <div class=\"ngx-emoji-mart\"\n      [ngStyle]=\"\n      {'background-color': (theme.martBG || DEFAULTS.martBG),\n       'width': (width || DEFAULTS.martWidth),\n       'height': (height || DEFAULTS.martHeight),\n       'font-family': (theme.martFontFamily || DEFAULTS.martFontFamily),\n       'border-radius': (theme.martBorderRadius || DEFAULTS.martBorderRadius)}\">\n      <ngx-emoj-header\n        *ngIf=\"theme.martShowHeader\"\n        [headerBG]=\"(theme.martHeaderBG || DEFAULTS.martHeaderBG)\"\n        [headerFG]=\"(theme.martHeaderFG || DEFAULTS.martHeaderFG)\"\n        [headerFontSize]=\"(theme.martHeaderFontSize || DEFAULTS.martHeaderFontSize)\"\n        [headerPadding]=\"(theme.martHeaderPadding || DEFAULTS.martHeaderPadding)\"\n        [defaultActiveCategory]=\"'People'\"\n        [activeCategory]=\"activeCategory\"\n        (oncategorychange)=\"handleCategoryChange($event)\"\n        [martCategoryFontSize]=\"(theme.martCategoryFontSize || DEFAULTS.martCategoryFontSize)\"\n        [martCategoryColor]=\"(theme.martCategoryColor || DEFAULTS.martCategoryColor)\"\n        [martCategoryColorActive]=\"(theme.martCategoryColorActive || DEFAULTS.martCategoryColorActive)\"\n        [activeIndicatorColor]=\"(theme.martActiveCategoryIndicatorColor || DEFAULTS.martActiveCategoryIndicatorColor)\"\n        [activeIndicatorHeight]=\"(theme.martActiveCategoryIndicatorHeight || DEFAULTS.martActiveCategoryIndicatorHeight)\"\n        [emojiCategories]=\"emojiCategories\">\n      </ngx-emoj-header>\n\n      <ngx-emoj-category-content\n      [categoryName]=\"activeCategory\"\n      [categoryEmojiSet]=\"activeEmojiSet\"\n      [activeIndex]=\"activeIndex\"\n      [martEmojiNotFoundFG]=\"(theme.martEmojiNotFoundFG || DEFAULTS.martEmojiNotFoundFG)\"\n      [emojiNotFoundText]=\"(emojiNotFoundText || DEFAULTS.emojiNotFoundText)\"\n      [searchBoxStyle]=\"(theme.martSearchBoxStyle || DEFAULTS.martSearchBoxStyle)\"\n      [searchEmojiPlaceholderText]=\"(searchEmojiPlaceholderText || DEFAULTS.searchEmojiPlaceholderText)\"\n      [emojiBtnPadding]=\"(theme.martEmojiPadding || DEFAULTS.martEmojiPadding)\"\n      [emojiFontSize]=\"(theme.martEmojiFontSize || DEFAULTS.martEmojiFontSize)\"\n      (onpickemoji)=\"handleEmojiPick($event)\"\n      (oncontentSwipe)=\"handleContentSwipe($event)\"\n      (oncontentscroll)=\"handleContentScroll($event)\">\n      </ngx-emoj-category-content>\n      <ngx-emoj-footer\n      *ngIf=\"theme.martShowFooter\"\n      [footerBG]=\"(theme.martFooterBG || DEFAULTS.martFooterBG)\"\n      [footerFG]=\"(theme.martFooterFG || DEFAULTS.martFooterFG)\"\n      [footerFontSize]=\"(theme.martFooterFontSize || DEFAULTS.martFooterFontSize)\"\n      [footerPadding]=\"(theme.martFooterPadding || DEFAULTS.martFooterPadding)\"\n      [defaultActiveEmo]=\"'Emoji'\"\n      (onchardelete)=\"handleCharDelete($event)\"\n      (onemochange)=\"handleEmoChange($event)\"\n      [martCategoryFontSize]=\"(theme.martCategoryFontSize || DEFAULTS.martCategoryFontSize)\"\n      [martCategoryColor]=\"(theme.martCategoryColor || DEFAULTS.martCategoryColor)\"\n      [martCategoryColorActive]=\"(theme.martCategoryColorActive || DEFAULTS.martCategoryColorActive)\"\n      [activeIndicatorColor]=\"(theme.martActiveCategoryIndicatorColor || DEFAULTS.martActiveCategoryIndicatorColor)\"\n      [activeIndicatorHeight]=\"(theme.martActiveCategoryIndicatorHeight || DEFAULTS.martActiveCategoryIndicatorHeight)\"\n      [emos]=\"emos\"\n      [hideFooter]=\"hideFooter\">\n    </ngx-emoj-footer>\n\n    </div>\n  ",
                    styles: ["\n\n    .ngx-emoji-mart\n    {\n      position: relative;\n      margin: 0;\n      margin-bottom: 10px;\n      padding: 0px;\n      box-sizing: border-box;\n      overflow: hidden;\n    }\n  "]
                }] }
    ];
    /** @nocollapse */
    NgxEmojComponent.ctorParameters = function () { return []; };
    NgxEmojComponent.propDecorators = {
        width: [{ type: Input }],
        height: [{ type: Input }],
        onemojipick: [{ type: Output }],
        onchardelete: [{ type: Output }],
        theme: [{ type: Input }],
        maxRecentEmoji: [{ type: Input }],
        recentEmojiStoreKey: [{ type: Input }],
        searchEmojiPlaceholderText: [{ type: Input }],
        emojiNotFoundText: [{ type: Input }]
    };
    return NgxEmojComponent;
}());
export { NgxEmojComponent };
if (false) {
    /** @type {?} */
    NgxEmojComponent.prototype.DEFAULTS;
    /** @type {?} */
    NgxEmojComponent.prototype.width;
    /** @type {?} */
    NgxEmojComponent.prototype.height;
    /** @type {?} */
    NgxEmojComponent.prototype.onemojipick;
    /** @type {?} */
    NgxEmojComponent.prototype.onchardelete;
    /** @type {?} */
    NgxEmojComponent.prototype.theme;
    /** @type {?} */
    NgxEmojComponent.prototype.emojiCategories;
    /** @type {?} */
    NgxEmojComponent.prototype.emos;
    /** @type {?} */
    NgxEmojComponent.prototype.activeCategory;
    /** @type {?} */
    NgxEmojComponent.prototype.activeEmo;
    /** @type {?} */
    NgxEmojComponent.prototype.activeIndex;
    /** @type {?} */
    NgxEmojComponent.prototype.activeEmojiSet;
    /** @type {?} */
    NgxEmojComponent.prototype.hideFooter;
    /** @type {?} */
    NgxEmojComponent.prototype.maxRecentEmoji;
    /** @type {?} */
    NgxEmojComponent.prototype.recentEmojiStoreKey;
    /** @type {?} */
    NgxEmojComponent.prototype.searchEmojiPlaceholderText;
    /** @type {?} */
    NgxEmojComponent.prototype.emojiNotFoundText;
    /** @type {?} */
    NgxEmojComponent.prototype.emojiDB;
    /** @type {?} */
    NgxEmojComponent.prototype.emojiDBKey;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LWVtb2ouY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vbmd4LWVtb2ovIiwic291cmNlcyI6WyJsaWIvbmd4LWVtb2ouY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLEtBQUssRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRy9FLE9BQU8sUUFBUSxNQUFNLGlCQUFpQixDQUFDO0FBQ3ZDLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUM1QyxPQUFPLEVBQUUsSUFBSSxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFJeEM7SUE0R0U7UUE5QlMsYUFBUSxHQUFHLFFBQVEsQ0FBQztRQUluQixnQkFBVyxHQUFRLElBQUksWUFBWSxDQUFDO1FBQ3BDLGlCQUFZLEdBQVEsSUFBSSxZQUFZLENBQUM7O1FBSXRDLFVBQUssR0FBVSxFQUFFLENBQUM7UUFFM0Isb0JBQWUsR0FBVSxFQUFFLENBQUM7O1FBRzVCLFNBQUksR0FBVyxFQUFFLENBQUM7UUFLbEIsZUFBVSxHQUFZLEtBQUssQ0FBQztJQVk1QixDQUFDOzs7O0lBRUQsbUNBQVE7OztJQUFSO1FBQUEsaUJBcUNDO1FBbkNDLGdDQUFnQztRQUNoQyxJQUFJLENBQUMsVUFBVSxHQUFJLElBQUksQ0FBQyxtQkFBbUIsSUFBSSxRQUFRLENBQUMsbUJBQW1CLENBQUM7UUFDNUUsc0JBQXNCO1FBQ3RCLElBQUksQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQzVELElBQUksSUFBSSxDQUFDLE9BQU8sRUFBRTtZQUNsQixJQUFJLENBQUMsT0FBTyxHQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1NBQ3hDO2FBQU07WUFDTCxzREFBc0Q7WUFDdEQsSUFBSSxDQUFD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Qzs7Z0JBdlNGLFNBQVMsU0FBQztvQkFDVCxRQUFRLEVBQUUsVUFBVTtvQkFDcEIsUUFBUSxFQUFFLDQ5R0EwRFQ7NkJBQ1EsaU1BV1I7aUJBQ0Y7Ozs7O3dCQU9FLEtBQUs7eUJBQ0wsS0FBSzs4QkFDTCxNQUFNOytCQUNOLE1BQU07d0JBSU4sS0FBSztpQ0FhTCxLQUFLO3NDQUNMLEtBQUs7NkNBQ0wsS0FBSztvQ0FDTCxLQUFLOztJQWtNUix1QkFBQztDQUFBLEFBelNELElBeVNDO1NBN05ZLGdCQUFnQjs7O0lBRTNCLG9DQUE2Qjs7SUFFN0IsaUNBQXVCOztJQUN2QixrQ0FBd0I7O0lBQ3hCLHVDQUE4Qzs7SUFDOUMsd0NBQStDOztJQUkvQyxpQ0FBMkI7O0lBRTNCLDJDQUE0Qjs7SUFHNUIsZ0NBQWtCOztJQUNsQiwwQ0FBdUI7O0lBQ3ZCLHFDQUFrQjs7SUFDbEIsdUNBQW9COztJQUNwQiwwQ0FBc0I7O0lBQ3RCLHNDQUE0Qjs7SUFHNUIsMENBQWdDOztJQUNoQywrQ0FBcUM7O0lBQ3JDLHNEQUE0Qzs7SUFDNUMsNkNBQW1DOztJQUVuQyxtQ0FBYTs7SUFDYixzQ0FBbUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgSW5wdXQsIE91dHB1dCwgRXZlbnRFbWl0dGVyIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCBUaGVtZSBmcm9tICcuL2ludGVyZmFjZXMvVGhlbWUnO1xuaW1wb3J0IERFRkFVTFRTIGZyb20gJy4vbWlzYy9kZWZhdWx0cyc7XG5pbXBvcnQgeyBFTU9KSVMgfSBmcm9tICcuL21pc2MvZW1vamlzLmRhdGEnO1xuaW1wb3J0IHsgRU1PUyB9IGZyb20gJy4vbWlzYy9lbW9zLmRhdGEnO1xuXG5cblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnbmd4LWVtb2onLFxuICB0ZW1wbGF0ZTogYFxuICAgIDxkaXYgY2xhc3M9XCJuZ3gtZW1vamktbWFydFwiXG4gICAgICBbbmdTdHlsZV09XCJcbiAgICAgIHsnYmFja2dyb3VuZC1jb2xvcic6ICh0aGVtZS5tYXJ0QkcgfHwgREVGQVVMVFMubWFydEJHKSxcbiAgICAgICAnd2lkdGgnOiAod2lkdGggfHwgREVGQVVMVFMubWFydFdpZHRoKSxcbiAgICAgICAnaGVpZ2h0JzogKGhlaWdodCB8fCBERUZBVUxUUy5tYXJ0SGVpZ2h0KSxcbiAgICAgICAnZm9udC1mYW1pbHknOiAodGhlbWUubWFydEZvbnRGYW1pbHkgfHwgREVGQVVMVFMubWFydEZvbnRGYW1pbHkpLFxuICAgICAgICdib3JkZXItcmFkaXVzJzogKHRoZW1lLm1hcnRCb3JkZXJSYWRpdXMgfHwgREVGQVVMVFMubWFydEJvcmRlclJhZGl1cyl9XCI+XG4gICAgICA8bmd4LWVtb2otaGVhZGVyXG4gICAgICAgICpuZ0lmPVwidGhlbWUubWFydFNob3dIZWFkZXJcIlxuICAgICAgICBbaGVhZGVyQkddPVwiKHRoZW1lLm1hcnRIZWFkZXJCRyB8fCBERUZBVUxUUy5tYXJ0SGVhZGVyQkcpXCJcbiAgICAgICAgW2hlYWRlckZHXT1cIih0aGVtZS5tYXJ0SGVhZGVyRkcgfHwgREVGQVVMVFMubWFydEhlYWRlckZHKVwiXG4gICAgICAgIFtoZWFkZXJGb250U2l6ZV09XCIodGhlbWUubWFydEhlYWRlckZvbnRTaXplIHx8IERFRkFVTFRTLm1hcnRIZWFkZXJGb250U2l6ZSlcIlxuICAgICAgICBbaGVhZGVyUGFkZGluZ109XCIodGhlbWUubWFydEhlYWRlclBhZGRpbmcgfHwgREVGQVVMVFMubWFydEhlYWRlclBhZGRpbmcpXCJcbiAgICAgICAgW2RlZmF1bHRBY3RpdmVDYXRlZ29yeV09XCInUGVvcGxlJ1wiXG4gICAgICAgIFthY3RpdmVDYXRlZ29yeV09XCJhY3RpdmVDYXRlZ29yeVwiXG4gICAgICAgIChvbmNhdGVnb3J5Y2hhbmdlKT1cImhhbmRsZUNhdGVnb3J5Q2hhbmdlKCRldmVudClcIlxuICAgICAgICBbbWFydENhdGVnb3J5Rm9udFNpemVdPVwiKHRoZW1lLm1hcnRDYXRlZ29yeUZvbnRTaXplIHx8IERFRkFVTFRTLm1hcnRDYXRlZ29yeUZvbnRTaXplKVwiXG4gICAgICAgIFttYXJ0Q2F0ZWdvcnlDb2xvcl09XCIodGhlbWUubWFydENhdGVnb3J5Q29sb3IgfHwgREVGQVVMVFMubWFydENhdGVnb3J5Q29sb3IpXCJcbiAgICAgICAgW21hcnRDYXRlZ29yeUNvbG9yQWN0aXZlXT1cIih0aGVtZS5tYXJ0Q2F0ZWdvcnlDb2xvckFjdGl2ZSB8fCBERUZBVUxUUy5tYXJ0Q2F0ZWdvcnlDb2xvckFjdGl2ZSlcIlxuICAgICAgICBbYWN0aXZlSW5kaWNhdG9yQ29sb3JdPVwiKHRoZW1lLm1hcnRBY3RpdmVDYXRlZ29yeUluZGljYXRvckNvbG9yIHx8IERFRkFVTFRTLm1hcnRBY3RpdmVDYXRlZ29yeUluZGljYXRvckNvbG9yKVwiXG4gICAgICAgIFthY3RpdmVJbmRpY2F0b3JIZWlnaHRdPVwiKHRoZW1lLm1hcnRBY3RpdmVDYXRlZ29yeUluZGljYXRvckhlaWdodCB8fCBERUZBVUxUUy5tYXJ0QWN0aXZlQ2F0ZWdvcnlJbmRpY2F0b3JIZWlnaHQpXCJcbiAgICAgICAgW2Vtb2ppQ2F0ZWdvcmllc109XCJlbW9qaUNhdGVnb3JpZXNcIj5cbiAgICAgIDwvbmd4LWVtb2otaGVhZGVyPlxuXG4gICAgICA8bmd4LWVtb2otY2F0ZWdvcnktY29udGVudFxuICAgICAgW2NhdGVnb3J5TmFtZV09XCJhY3RpdmVDYXRlZ29yeVwiXG4gICAgICBbY2F0ZWdvcnlFbW9qaVNldF09XCJhY3RpdmVFbW9qaVNldFwiXG4gICAgICBbYWN0aXZlSW5kZXhdPVwiYWN0aXZlSW5kZXhcIlxuICAgICAgW21hcnRFbW9qaU5vdEZvdW5kRkddPVwiKHRoZW1lLm1hcnRFbW9qaU5vdEZvdW5kRkcgfHwgREVGQVVMVFMubWFydEVtb2ppTm90Rm91bmRGRylcIlxuICAgICAgW2Vtb2ppTm90Rm91bmRUZXh0XT1cIihlbW9qaU5vdEZvdW5kVGV4dCB8fCBERUZBVUxUUy5lbW9qaU5vdEZvdW5kVGV4dClcIlxuICAgICAgW3NlYXJjaEJveFN0eWxlXT1cIih0aGVtZS5tYXJ0U2VhcmNoQm94U3R5bGUgfHwgREVGQVVMVFMubWFydFNlYXJjaEJveFN0eWxlKVwiXG4gICAgICBbc2VhcmNoRW1vamlQbGFjZWhvbGRlclRleHRdPVwiKHNlYXJjaEVtb2ppUGxhY2Vob2xkZXJUZXh0IHx8IERFRkFVTFRTLnNlYXJjaEVtb2ppUGxhY2Vob2xkZXJUZXh0KVwiXG4gICAgICBbZW1vamlCdG5QYWRkaW5nXT1cIih0aGVtZS5tYXJ0RW1vamlQYWRkaW5nIHx8IERFRkFVTFRTLm1hcnRFbW9qaVBhZGRpbmcpXCJcbiAgICAgIFtlbW9qaUZvbnRTaXplXT1cIih0aGVtZS5tYXJ0RW1vamlGb250U2l6ZSB8fCBERUZBVUxUUy5tYXJ0RW1vamlGb250U2l6ZSlcIlxuICAgICAgKG9ucGlja2Vtb2ppKT1cImhhbmRsZUVtb2ppUGljaygkZXZlbnQpXCJcbiAgICAgIChvbmNvbnRlbnRTd2lwZSk9XCJoYW5kbGVDb250ZW50U3dpcGUoJGV2ZW50KVwiXG4gICAgICAob25jb250ZW50c2Nyb2xsKT1cImhhbmRsZUNvbnRlbnRTY3JvbGwoJGV2ZW50KVwiPlxuICAgICAgPC9uZ3gtZW1vai1jYXRlZ29yeS1jb250ZW50PlxuICAgICAgPG5neC1lbW9qLWZvb3RlclxuICAgICAgKm5nSWY9XCJ0aGVtZS5tYXJ0U2hvd0Zvb3RlclwiXG4gICAgICBbZm9vdGVyQkddPVwiKHRoZW1lLm1hcnRGb290ZXJCRyB8fCBERUZBVUxUUy5tYXJ0Rm9vdGVyQkcpXCJcbiAgICAgIFtmb290ZXJGR109XCIodGhlbWUubWFydEZvb3RlckZHIHx8IERFRkFVTFRTLm1hcnRGb290ZXJGRylcIlxuICAgICAgW2Zvb3RlckZvbnRTaXplXT1cIih0aGVtZS5tYXJ0Rm9vdGVyRm9udFNpemUgfHwgREVGQVVMVFMubWFydEZvb3RlckZvbnRTaXplKVwiXG4gICAgICBbZm9vdGVyUGFkZGluZ109XCIodGhlbWUubWFydEZvb3RlclBhZGRpbmcgfHwgREVGQVVMVFMubWFydEZvb3RlclBhZGRpbmcpXCJcbiAgICAgIFtkZWZhdWx0QWN0aXZlRW1vXT1cIidFbW9qaSdcIlxuICAgICAgKG9uY2hhcmRlbGV0ZSk9XCJoYW5kbGVDaGFyRGVsZXRlKCRldmVudClcIlxuICAgICAgKG9uZW1vY2hhbmdlKT1cImhhbmRsZUVtb0NoYW5nZSgkZXZlbnQpXCJcbiAgICAgIFttYXJ0Q2F0ZWdvcnlGb250U2l6ZV09XCIodGhlbWUubWFydENhdGVnb3J5Rm9udFNpemUgfHwgREVGQVVMVFMubWFydENhdGVnb3J5Rm9udFNpemUpXCJcbiAgICAgIFttYXJ0Q2F0ZWdvcnlDb2xvcl09XCIodGhlbWUubWFydENhdGVnb3J5Q29sb3IgfHwgREVGQVVMVFMubWFydENhdGVnb3J5Q29sb3IpXCJcbiAgICAgIFttYXJ0Q2F0ZWdvcnlDb2xvckFjdGl2ZV09XCIodGhlbWUubWFydENhdGVnb3J5Q29sb3JBY3RpdmUgfHwgREVGQVVMVFMubWFydENhdGVnb3J5Q29sb3JBY3RpdmUpXCJcbiAgICAgIFthY3RpdmVJbmRpY2F0b3JDb2xvcl09XCIodGhlbWUubWFydEFjdGl2ZUNhdGVnb3J5SW5kaWNhdG9yQ29sb3IgfHwgREVGQVVMVFMubWFydEFjdGl2ZUNhdGVnb3J5SW5kaWNhdG9yQ29sb3IpXCJcbiAgICAgIFthY3RpdmVJbmRpY2F0b3JIZWlnaHRdPVwiKHRoZW1lLm1hcnRBY3RpdmVDYXRlZ29yeUluZGljYXRvckhlaWdodCB8fCBERUZBVUxUUy5tYXJ0QWN0aXZlQ2F0ZWdvcnlJbmRpY2F0b3JIZWlnaHQpXCJcbiAgICAgIFtlbW9zXT1cImVtb3NcIlxuICAgICAgW2hpZGVGb290ZXJdPVwiaGlkZUZvb3RlclwiPlxuICAgIDwvbmd4LWVtb2otZm9vdGVyPlxuXG4gICAgPC9kaXY+XG4gIGAsXG4gIHN0eWxlczogW2BcblxuICAgIC5uZ3gtZW1vamktbWFydFxuICAgIHtcbiAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgICAgIG1hcmdpbjogMDtcbiAgICAgIG1hcmdpbi1ib3R0b206IDEwcHg7XG4gICAgICBwYWRkaW5nOiAwcHg7XG4gICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICAgICAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgICB9XG4gIGBdXG59KVxuXG5cbmV4cG9ydCBjbGFzcyBOZ3hFbW9qQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcblxuICByZWFkb25seSBERUZBVUxUUyA9IERFRkFVTFRTO1xuXG4gIEBJbnB1dCgpIHdpZHRoOiBzdHJpbmc7XG4gIEBJbnB1dCgpIGhlaWdodDogc3RyaW5nO1xuICBAT3V0cHV0KCkgb25lbW9qaXBpY2s6IGFueSA9IG5ldyBFdmVudEVtaXR0ZXI7XG4gIEBPdXRwdXQoKSBvbmNoYXJkZWxldGU6IGFueSA9IG5ldyBFdmVudEVtaXR0ZXI7XG5cblxuICAvLyBJbml0aWFsbHkgIGFwcGx5IGRlZmF1bHQgY29uZmlnLi4uXG4gIEBJbnB1dCgpIHRoZW1lOiBUaGVtZSA9IHt9O1xuXG4gIGVtb2ppQ2F0ZWdvcmllczogYW55W10gPSBbXTtcblxuICAvLyBsaXN0IG9mIGVtb3MgdHlwZSwgZS5nIGVtb2ppLCBnaWZzLCBzdGlja2Vycy4uLlxuICBlbW9zOiBhbnkgW10gPSBbXTtcbiAgYWN0aXZlQ2F0ZWdvcnk6IHN0cmluZztcbiAgYWN0aXZlRW1vOiBzdHJpbmc7XG4gIGFjdGl2ZUluZGV4OiBudW1iZXI7XG4gIGFjdGl2ZUVtb2ppU2V0OiBhbnlbXTtcbiAgaGlkZUZvb3RlcjogQm9vbGVhbiA9IGZhbHNlO1xuXG5cbiAgQElucHV0KCkgbWF4UmVjZW50RW1vamk6IHN0cmluZztcbiAgQElucHV0KCkgcmVjZW50RW1vamlTdG9yZUtleTogc3RyaW5nO1xuICBASW5wdXQoKSBzZWFyY2hFbW9qaVBsYWNlaG9sZGVyVGV4dDogc3RyaW5nO1xuICBASW5wdXQoKSBlbW9qaU5vdEZvdW5kVGV4dDogc3RyaW5nO1xuXG4gIGVtb2ppREI6IGFueTtcbiAgZW1vamlEQktleTogc3RyaW5nO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICB9XG5cbiAgbmdPbkluaXQoKSB7XG5cbiAgICAvLyBTZXQgcmVjZW50IGVtb2ppIHN0b3JlIGtleS4uLlxuICAgIHRoaXMuZW1vamlEQktleSAgPSB0aGlzLnJlY2VudEVtb2ppU3RvcmVLZXkgfHwgREVGQVVMVFMucmVjZW50RW1vamlTdG9yZUtleTtcbiAgICAvLyBHZXQgcmVjZW50IGVtb2ppcy4uXG4gICAgdGhpcy5lbW9qaURCID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKHRoaXMuZW1vamlEQktleSk7XG4gICAgaWYgKHRoaXMuZW1vamlEQikge1xuICAgIHRoaXMuZW1vamlEQiA9ICBKU09OLnBhcnNlKHRoaXMuZW1vamlEQik7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIG5vIHN0b3JlZCByZWNlbnQgZW1vamksIHNhdmUgaW4gdGhlIHN0b3JlIGFycmF5IC4uLlxuICAgICAgdGhpcy5lbW9qaURCID0gW107XG4gICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0odGhpcy5lbW9qaURCS2V5LCBKU09OLnN0cmluZ2lmeSh0aGlzLmVtb2ppREIpKTtcbiAgICB9XG5cbiAgICB0aGlzLmFjdGl2ZUNhdGVnb3J5ID0gJ1Blb3BsZSc7XG4gICAgLy8gZ2V0IHRoZSBlbW9qaSBjYXRlZ29yaWVzXG4gICAgdGhpcy5lbW9qaUNhdGVnb3JpZXMgPSBFTU9KSVMubWFwKCh2YWx1ZSkgPT4ge1xuICAgICAgcmV0dXJuIHtuYW1lOiB2YWx1ZS5uYW1lLCBpY29uOiB2YWx1ZS5pY29ufTtcbiAgICB9KTtcblxuICAgIC8vIGZpbHRlciB0byBzZXQgZGVmYXVsdHNcbiAgICB0aGlzLmFjdGl2ZUVtb2ppU2V0ID0gRU1PSklTLmZpbHRlcigoY2F0ZWdvcnkpID0+IHtcbiAgICAgIGlmIChjYXRlZ29yeS5uYW1lID09PSB0aGlzLmFjdGl2ZUNhdGVnb3J5KSB7XG4gICAgICAgICAgICByZXR1cm4gY2F0ZWdvcnk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB0aGlzLmFjdGl2ZUluZGV4ID0gdGhpcy5hY3RpdmVFbW9qaVNldFswXS5pZDtcbiAgICAvLyBjb25zb2xlLmxvZygnSW5pdGlhbCBFbW8gSW5kZXg6JywgdGhpcy5hY3RpdmVJbmRleCk7XG4gICAgdGhpcy5hY3RpdmVFbW9qaVNldCA9IHRoaXMuYWN0aXZlRW1vamlTZXRbMF0uZW1vamlzO1xuXG5cbiAgICB0aGlzLmFjdGl2ZUVtbyA9ICdFbW9qaSc7XG4gICAgLy8gY29sbGF0ZSB0aGUgZW1vcyB0eXBlXG4gICAgdGhpcy5lbW9zID0gRU1PUy5tYXAoKHZhbHVlKSA9PiB7XG4gICAgICByZXR1cm4ge25hbWU6IHZhbHVlLm5hbWUsIGljb246IHZhbHVlLmljb259O1xuICAgIH0pO1xuICB9XG5cbiAgaGFuZGxlQ2F0ZWdvcnlDaGFuZ2UoZSkge1xuICAgIC8vIHNldCBhY3RpdmUgY2F0ZWdvcnkgbmFtZS4uLlxuICAgIHRoaXMuYWN0aXZlQ2F0ZWdvcnkgPSBlLm5hbWU7XG5cbiAgICBpZiAoZS5uYW1lID09PSAnUmVjZW50Jykge1xuICAgICAgICAvLyBJZiByZWNlbnQgY2F0ZWdvcnksIHNldCBlbW9qaSB0byBlbW9qaXMgaW4gdGhlIHJlY2VudCBzdG9yZS4uLlxuICAgICAgICB0aGlzLmFjdGl2ZUluZGV4ID0gRU1PSklTWzFdLmlkO1xuICAgICAgICB0aGlzLmFjdGl2ZUVtb2ppU2V0ID0gdGhpcy5lbW9qaURCO1xuICAgICAgfSBlbHNlIGlmIChlLm5hbWUgPT09ICdTZWFyY2gnKSB7XG4gICAgICAgICAgdGhpcy5hY3RpdmVJbmRleCA9IEVNT0pJU1swXS5pZDtcbiAgICAgICAgICB0aGlzLmFjdGl2ZUVtb2ppU2V0ID0gdGhpcy5lbW9qaURCLmNvbmNhdChFTU9KSVNbMl0uZW1vamlzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAvLyBmaWx0ZXIgdG8gc2V0IGN1cnJlbnQgZW1vamkgc2V0Li4uXG4gICAgICAgICAgICB0aGlzLmFjdGl2ZUVtb2ppU2V0ID0gRU1PSklTLmZpbHRlcigoY2F0ZWdvcnkpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoY2F0ZWdvcnkubmFtZSA9PT0gdGhpcy5hY3RpdmVDYXRlZ29yeSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2F0ZWdvcnk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgLy8gdXBkYXRlIHRoZSBpbmRleCBvbiBtYW51YWwgY2hhbmdlLi4uXG4gICAgICAgICAgICB0aGlzLmFjdGl2ZUluZGV4ID0gdGhpcy5hY3RpdmVFbW9qaVNldFswXS5pZDtcbiAgICAgICAgICAgIHRoaXMuYWN0aXZlRW1vamlTZXQgPSB0aGlzLmFjdGl2ZUVtb2ppU2V0WzBdLmVtb2ppcztcblxuICAgICAgfVxuICB9XG5cbiAgaGFuZGxlRW1vQ2hhbmdlKGUpIHtcbiAgICB0aGlzLmFjdGl2ZUVtbyA9IGUubmFtZTtcbiAgICAvLyBjb2xsYXRlIHRoZSBlbW9zIHR5cGVcbiAgLy8gICB0aGlzLmVtb3MgPSBFTU9TLm1hcCgodmFsdWUpID0+IHtcbiAgLy8gICAgcmV0dXJuIHtuYW1lOiB2YWx1ZS5uYW1lLCBpY29uOiB2YWx1ZS5pY29ufTtcbiAgLy8gIH0pO1xuIH1cblxuIGNoZWNrSWZFbW9qaUV4aXN0c0luRW1vamlEQihuYW1lKSB7XG4gIGxldCBlbW9fZXhpc3RzID0gZmFsc2U7XG4gIC8vIGNoZWNrcyBpZiBlbW9qaSBpcyBhbHJlYWR5IGluIHJlY2VudCBlbW9qaSBkYiBzdG9yZS4uLlxuICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZW1vamlEQi5sZW5ndGg7IGkrKykge1xuICAgIGlmICh0aGlzLmVtb2ppREJbaV1bMV0gPT09IG5hbWUpIHtcbiAgICAgIGVtb19leGlzdHMgPSB0cnVlO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGVtb19leGlzdHM7XG5cbiB9XG4gIGFkZEVtb2ppVG9SZWNlbnRFbW9qaURCKGVtb2ppOiBzdHJpbmdbXSkge1xuICAgIC8vIGNoZWNrIGlmIHRoZXJlIGlzIG5vIGR1cGxpY2F0ZVxuICAgIGlmICghdGhpcy5jaGVja0lmRW1vamlFeGlzdHNJbkVtb2ppREIoZW1vamlbMV0pKSB7XG4gICAgICAgIC8vIHJlY2VudCBlbW9qaSBncmVhdGVyIHRoYW4gdGhlIG51bWJlciBvZiBtYXgsIHJlbW92ZSB0aGUgZmlyc3QgZW1vamkgYW5kIGFkZCBuZXcgb25lXG4gICAgICAgIC8vIHRvIHRoZSBiYWNrLi4uXG4gICAgICAgIGlmICh0aGlzLmVtb2ppREIubGVuZ3RoIDwgKHRoaXMubWF4UmVjZW50RW1vamkgfHwgREVGQVVMVFMubWF4UmVjZW50RW1vamkpKSB7XG4gICAgICAgICAgdGhpcy5lbW9qaURCLnB1c2goZW1vamkpO1xuICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSh0aGlzLmVtb2ppREJLZXksIEpTT04uc3RyaW5naWZ5KHRoaXMuZW1vamlEQikpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5lbW9qaURCLnNwbGljZSgwLCAxKTtcbiAgICAgICAgdGhpcy5lbW9qaURCLnB1c2goZW1vamkpO1xuICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0odGhpcy5lbW9qaURCS2V5LCBKU09OLnN0cmluZ2lmeSh0aGlzLmVtb2ppREIpKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuXG4gIGhhbmRsZUVtb2ppUGljayhlKSB7XG5cbiAgICAvLyBzYXZlIHRoZSBwaWNrZWQgZW1vamkgaW5zaWRlIHJlY2VudCBlbW9qaSBEQlxuICAgIHRoaXMuYWRkRW1vamlUb1JlY2VudEVtb2ppREIoZS5lbW9qaSk7XG5cbiAgICB0aGlzLm9uZW1vamlwaWNrLmVtaXQoe2NoYXI6IGUuZW1vamlbMF0sIG5hbWU6IGUuZW1vamlbMV19KTtcbiAgfVxuXG4gIGhhbmRsZUNoYXJEZWxldGUoZSkge1xuICAgIHRoaXMub25jaGFyZGVsZXRlLmVtaXQoe2RlbGV0ZUNoYXI6IHRydWV9KTtcbiAgfVxuXG4gIGhhbmRsZUNvbnRlbnRTY3JvbGwoZSkge1xuICAgIC8vIGNvbnNvbGUubG9nKCdlbWl0dGVkJywgZS5zY3JvbGxUb3AsIGUuc2Nyb2xsSGVpZ2h0KTtcblxuICAgIGlmICgoZS5zY3JvbGxIZWlnaHQgLSBlLnNjcm9sbFRvcCkgPD0gNDAwKSB7XG5cbiAgICAgIC8vIGNvbnNvbGUubG9nKCdhbG1vc3QgYXQgdGhlIGVuZCcpO1xuICAgICAgdGhpcy5oaWRlRm9vdGVyID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gY29uc29sZS5sb2coJ3Rvb3BpbmcgdGhlIHNjcm9sbCcpO1xuICAgICAgdGhpcy5oaWRlRm9vdGVyID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgaGFuZGxlQ29udGVudFN3aXBlKGUpIHtcbiAgICBjb25zdCBjdXJyZW50SW5kZXggPSB0aGlzLmFjdGl2ZUluZGV4O1xuICAgIGNvbnN0IGRpcmVjdGlvbiA9IGUuZGlyZWN0aW9uO1xuICAgIC8vIExvZyB0aGUgbmVjZXNzYXJ5IGRldGFpbHMuLi5cbiAgICBpZiAoZGlyZWN0aW9uID09PSAnbGVmdCcpIHtcbiAgICAgIGNvbnN0IHByZXY6IG51bWJlciA9IGN1cnJlbnRJbmRleCAtIDE7XG4gICAgICBpZiAocHJldiA+PSAwKSB7XG5cbiAgICAgICAgaWYgKHByZXYgPT09IDApIHtcbiAgICAgICAgICAvLyBzZWFyY2hcbiAgICAgICAgICB0aGlzLmFjdGl2ZUluZGV4ID0gRU1PSklTWzBdLmlkO1xuICAgICAgICAgIHRoaXMuYWN0aXZlQ2F0ZWdvcnkgPSBFTU9KSVNbMF0ubmFtZTtcbiAgICAgICAgICB0aGlzLmFjdGl2ZUVtb2ppU2V0ID0gdGhpcy5lbW9qaURCLmNvbmNhdChFTU9KSVNbMl0uZW1vamlzKTtcbiAgICAgICAgfSBlbHNlIGlmIChwcmV2ID09PSAxICkge1xuICAgICAgICAgIC8vIHJlY2VudFxuICAgICAgICAgIHRoaXMuYWN0aXZlSW5kZXggPSBFTU9KSVNbMV0uaWQ7XG4gICAgICAgICAgdGhpcy5hY3RpdmVDYXRlZ29yeSA9IEVNT0pJU1sxXS5uYW1lO1xuICAgICAgICAgIHRoaXMuYWN0aXZlRW1vamlTZXQgPSB0aGlzLmVtb2ppREI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc3QgcHJldkNhdGVnb3J5RGF0YSA9IEVNT0pJUy5maWx0ZXIoKGNhdGVnb3J5KSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGNhdGVnb3J5LmlkID09PSBwcmV2KSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gY2F0ZWdvcnk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyBzZXQgdGhlIHZhbHVlcy4uLlxuICAgICAgICAgICAgdGhpcy5hY3RpdmVJbmRleCA9IHByZXY7XG4gICAgICAgICAgICB0aGlzLmFjdGl2ZUNhdGVnb3J5ID0gcHJldkNhdGVnb3J5RGF0YVswXS5uYW1lO1xuICAgICAgICAgICAgdGhpcy5hY3RpdmVFbW9qaVNldCA9IHByZXZDYXRlZ29yeURhdGFbMF0uZW1vamlzO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChkaXJlY3Rpb24gPT09ICdyaWdodCcpIHtcbiAgICAgICAgY29uc3QgbmV4dCA9IGN1cnJlbnRJbmRleCArIDE7XG4gICAgICAgIGlmIChuZXh0ID09PSAwKSB7XG4gICAgICAgICAgLy8gc2VhcmNoXG4gICAgICAgICAgdGhpcy5hY3RpdmVJbmRleCA9IEVNT0pJU1swXS5pZDtcbiAgICAgICAgICB0aGlzLmFjdGl2ZUNhdGVnb3J5ID0gRU1PSklTWzBdLm5hbWU7XG4gICAgICAgICAgdGhpcy5hY3RpdmVFbW9qaVNldCA9IHRoaXMuZW1vamlEQi5jb25jYXQoRU1PSklTWzJdLmVtb2ppcyk7XG4gICAgICAgIH0gZWxzZSBpZiAobmV4dCA9PT0gMSApIHtcbiAgICAgICAgICAvLyByZWNlbnRcbiAgICAgICAgICB0aGlzLmFjdGl2ZUluZGV4ID0gRU1PSklTWzFdLmlkO1xuICAgICAgICAgIHRoaXMuYWN0aXZlRW1vamlTZXQgPSB0aGlzLmVtb2ppREI7XG4gICAgICAgICAgdGhpcy5hY3RpdmVDYXRlZ29yeSA9IEVNT0pJU1sxXS5uYW1lO1xuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKG5leHQgPD0gKEVNT0pJUy5sZW5ndGggLSAxKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHByZXZDYXRlZ29yeURhdGEgPSBFTU9KSVMuZmlsdGVyKChjYXRlZ29yeSkgPT4ge1xuICAgICAgICAgICAgICAgICAgaWYgKGNhdGVnb3J5LmlkID09PSBuZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjYXRlZ29yeTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIC8vIHNldCB0aGUgdmFsdWVzLi4uXG4gICAgICAgICAgICAgIHRoaXMuYWN0aXZlSW5kZXggPSBuZXh0O1xuICAgICAgICAgICAgICB0aGlzLmFjdGl2ZUNhdGVnb3J5ID0gcHJldkNhdGVnb3J5RGF0YVswXS5uYW1lO1xuICAgICAgICAgICAgICB0aGlzLmFjdGl2ZUVtb2ppU2V0ID0gcHJldkNhdGVnb3J5RGF0YVswXS5lbW9qaXM7XG4gICAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG59XG5cbiJdfQ==